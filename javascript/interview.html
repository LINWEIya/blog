<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>常见知识点理解 | CoderLin</title>
    <meta name="description" content="">
    <link rel="icon" href="/blog/photo.jpg">
    
    <link rel="preload" href="/blog/assets/css/0.styles.b83d0e5b.css" as="style"><link rel="preload" href="/blog/assets/js/app.88060982.js" as="script"><link rel="preload" href="/blog/assets/js/2.8cf76fce.js" as="script"><link rel="preload" href="/blog/assets/js/11.5de2d7f7.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.f2c5d971.js"><link rel="prefetch" href="/blog/assets/js/12.301819bb.js"><link rel="prefetch" href="/blog/assets/js/13.643d516e.js"><link rel="prefetch" href="/blog/assets/js/3.ef2a6444.js"><link rel="prefetch" href="/blog/assets/js/4.e27b6726.js"><link rel="prefetch" href="/blog/assets/js/5.4e756a74.js"><link rel="prefetch" href="/blog/assets/js/6.cec5c6c6.js"><link rel="prefetch" href="/blog/assets/js/7.5c301d01.js"><link rel="prefetch" href="/blog/assets/js/8.ccffb27e.js"><link rel="prefetch" href="/blog/assets/js/9.5d2be3ce.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.b83d0e5b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">CoderLin</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><a href="/blog/html/" class="nav-link">HTML</a></div><div class="nav-item"><a href="/blog/css/" class="nav-link">CSS</a></div><div class="nav-item"><a href="/blog/javascript/" class="nav-link router-link-active">JavaScript</a></div><div class="nav-item"><a href="/blog/webpack/" class="nav-link">webpack</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端框架" class="dropdown-title"><span class="title">前端框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/jquery.html" class="nav-link">jQuery</a></li><li class="dropdown-item"><!----> <a href="/blog/vue.html" class="nav-link">Vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端书籍" class="dropdown-title"><span class="title">前端书籍</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/javaScript-datastructures-algorithms-book.html" class="nav-link">学习JavaScript数据结构与算法</a></li><li class="dropdown-item"><!----> <a href="/blog/javaScript-core-development-book.html" class="nav-link">JavaScript核心技术开发解密</a></li><li class="dropdown-item"><!----> <a href="/blog/interview-book.html" class="nav-link">前端面试江湖</a></li></ul></div></div> <a href="https://github.com/LINWEIya/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">首页</a></div><div class="nav-item"><a href="/blog/html/" class="nav-link">HTML</a></div><div class="nav-item"><a href="/blog/css/" class="nav-link">CSS</a></div><div class="nav-item"><a href="/blog/javascript/" class="nav-link router-link-active">JavaScript</a></div><div class="nav-item"><a href="/blog/webpack/" class="nav-link">webpack</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端框架" class="dropdown-title"><span class="title">前端框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/jquery.html" class="nav-link">jQuery</a></li><li class="dropdown-item"><!----> <a href="/blog/vue.html" class="nav-link">Vue</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端书籍" class="dropdown-title"><span class="title">前端书籍</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/javaScript-datastructures-algorithms-book.html" class="nav-link">学习JavaScript数据结构与算法</a></li><li class="dropdown-item"><!----> <a href="/blog/javaScript-core-development-book.html" class="nav-link">JavaScript核心技术开发解密</a></li><li class="dropdown-item"><!----> <a href="/blog/interview-book.html" class="nav-link">前端面试江湖</a></li></ul></div></div> <a href="https://github.com/LINWEIya/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/blog/javascript/interview.html" class="active sidebar-link">常见知识点理解</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/javascript/interview.html#_1、上下文-vs-作用域" class="sidebar-link">1、上下文 vs 作用域</a></li><li class="sidebar-sub-header"><a href="/blog/javascript/interview.html#_2、undefined和null有什么区别？" class="sidebar-link">2、undefined和null有什么区别？</a></li><li class="sidebar-sub-header"><a href="/blog/javascript/interview.html#_3、-与-的区别" class="sidebar-link">3、==与===的区别</a></li><li class="sidebar-sub-header"><a href="/blog/javascript/interview.html#_4、箭头函数与function区别" class="sidebar-link">4、箭头函数与function区别</a></li><li class="sidebar-sub-header"><a href="/blog/javascript/interview.html#_5、面向对象" class="sidebar-link">5、面向对象</a></li><li class="sidebar-sub-header"><a href="/blog/javascript/interview.html#_6、数组去重" class="sidebar-link">6、数组去重</a></li><li class="sidebar-sub-header"><a href="/blog/javascript/interview.html#_7、谈谈闭包" class="sidebar-link">7、谈谈闭包</a></li><li class="sidebar-sub-header"><a href="/blog/javascript/interview.html#_8、es6的新特性" class="sidebar-link">8、ES6的新特性</a></li><li class="sidebar-sub-header"><a href="/blog/javascript/interview.html#_9、es6遍历数组的方法区别" class="sidebar-link">9、ES6遍历数组的方法区别</a></li><li class="sidebar-sub-header"><a href="/blog/javascript/interview.html#_10、用reduce实现promise串行执行" class="sidebar-link">10、用reduce实现Promise串行执行</a></li><li class="sidebar-sub-header"><a href="/blog/javascript/interview.html#_11、浏览器javascript的eventloop" class="sidebar-link">11、浏览器JavaScript的EventLoop</a></li></ul></li><li><a href="/blog/javascript/handwriting.html" class="sidebar-link">手写代码</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="常见知识点理解"><a href="#常见知识点理解" class="header-anchor">#</a> 常见知识点理解</h1> <h2 id="_1、上下文-vs-作用域"><a href="#_1、上下文-vs-作用域" class="header-anchor">#</a> 1、上下文 vs 作用域</h2> <p>（1）首先需要说明的是<strong>上下文和作用域是不同的概念</strong>。</p> <p>（2）每个函数调用都有与之相关的<code>作用域</code>和<code>上下文</code>。从根本上说，作用域是基于<strong>函数</strong>，而上下文是基于<strong>对象</strong>。</p> <p>（3）作用域是和每次<strong>函数调用时变量的访问有关</strong>，并且<strong>每次调用都是独立的</strong>。上下文总是关键字 <strong>this 的值</strong>，是调用当前可执行代码的对象的引用。</p> <p>（4）当函数执行时，会创建一个称为<code>执行上下文</code>的内部对象（<strong>可理解为作用域，不是前面讨论的上下文</strong>）。一个<code>执行上下文</code>定义了一个<strong>函数执行时的环境</strong>。</p> <h2 id="_2、undefined和null有什么区别？"><a href="#_2、undefined和null有什么区别？" class="header-anchor">#</a> 2、undefined和null有什么区别？</h2> <p><code>undefined</code>是未指定特定值的变量的默认值，或者没有显式返回值的函数，如：<code>console.log(1)</code>，还包括对象中不存在的属性，这些 JS 引擎都会为其分配 <code>undefined</code> 值。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> _thisIsUndefined<span class="token punctuation">;</span>
<span class="token function-variable function">const doNothing </span><span class="token operator">=</span><span class="token function"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token parameter"> </span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> someObj <span class="token operator">=</span> <span class="token punctuation">{</span>  a <span class="token operator">:</span> <span class="token string">&quot;ay&quot;</span><span class="token punctuation">,</span>  b <span class="token operator">:</span> <span class="token string">&quot;bee&quot;</span><span class="token punctuation">,</span>  c <span class="token operator">:</span> <span class="token string">&quot;si&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_thisIsUndefined<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">doNothing</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>someObj<span class="token punctuation">[</span><span class="token string">&quot;d&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
</code></pre></div><p><code>null</code>是**“不代表任何值的值”**。 <code>null</code>是已明确定义给变量的值。</p> <h2 id="_3、-与-的区别"><a href="#_3、-与-的区别" class="header-anchor">#</a> 3、==与===的区别</h2> <p><code>===</code> 严格相等，会比较两个值的<strong>类型</strong>和<strong>值</strong></p> <p><code>==</code> 抽象相等，比较时，会先进行<strong>类型转换</strong>，然后再比较<strong>值</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>例子：<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">==</span><span class="token template-punctuation string">`</span></span>  会有隐式转换类型规则，
<span class="token number">1.</span><span class="token number">NaN</span>
<span class="token number">NaN</span>和其他任何类型比较永远返回<span class="token boolean">false</span><span class="token punctuation">(</span>包括和他自己<span class="token punctuation">)</span>。

<span class="token number">2.</span>Boolean
Boolean和其他任何类型比较，Boolean首先被转换为Number类型。

<span class="token number">3.</span>String和Number
String和Number比较，先将String转换为Number类型。
<span class="token string">'123'</span> <span class="token operator">==</span> <span class="token number">123</span>

<span class="token number">4.</span>null和<span class="token keyword">undefined</span>
<span class="token keyword">null</span> <span class="token operator">==</span> <span class="token keyword">undefined</span>比较结果是<span class="token boolean">true</span>，除此之外，<span class="token keyword">null</span>、<span class="token keyword">undefined</span>和其他任何结果的比较值都为<span class="token boolean">false</span>。

<span class="token number">5.</span>原始类型和引用类型
当原始类型和引用类型做比较时，对象类型会依照ToPrimitive规则转换为原始类型<span class="token operator">:</span>

一道经典的面试题，如何让：a <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> a <span class="token operator">==</span> <span class="token number">3</span>。
根据拆箱转换，以及<span class="token operator">==</span>的隐式转换，我们可以轻松写出答案：
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
    value<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token function-variable function">valueOf</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> 
</code></pre></div><h2 id="_4、箭头函数与function区别"><a href="#_4、箭头函数与function区别" class="header-anchor">#</a> 4、箭头函数与function区别</h2> <p>箭头函数是普通函数的简写，可以更优雅的定义一个函数，和普通函数相比，有以下几点差异：</p> <ul><li><p>函数体内的 <code>this 对象</code>，它会从自己的作用域链的上一层继承<code>this</code>（因此无法使用 apply / call / bind 进行绑定 this 值）。也就是<strong>函数执行位置的上下文this</strong></p></li> <li><p>不可以使用 <code>arguments</code> 对象，该对象在函数体内不存在。如果要用，可以用 <code>rest 参数</code>代替。</p></li> <li><p>不可以使用<code>yield</code> 命令，因此箭头函数不能用作<code>Generator</code>函数。</p></li> <li><p>相当于匿名函数，是不能作为构造函数的，不可以使用 <code>new</code>命令，因为：</p> <ul><li><p>没有自己的<code>this</code>，无法调用 call，apply。</p></li> <li><p>没有<code>prototype</code> 属性 ，而 <code>new 命令</code>在执行时需要将构造函数的 <code>prototype</code>赋值给新的对象的 <code>__proto__</code></p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// new 过程大致是这样的：</span>
<span class="token keyword">function</span> <span class="token function">_new</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  	<span class="token keyword">var</span> constructor <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 声明一个中间对象,将实例的原型指向构造函数的原型</span>
  	<span class="token keyword">var</span> context <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>constructor<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 相当于：</span>
    <span class="token comment">// var context = {};</span>
    <span class="token comment">// context.__proto__ = constructor.prototype;</span>
    
  	<span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">constructor</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  	<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> result <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span> result <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> result <span class="token operator">:</span> context<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> actor <span class="token operator">=</span> <span class="token function">_new</span><span class="token punctuation">(</span>Person<span class="token punctuation">,</span> <span class="token string">&quot;张三&quot;</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h2 id="_5、面向对象"><a href="#_5、面向对象" class="header-anchor">#</a> 5、面向对象</h2> <h3 id="原型链"><a href="#原型链" class="header-anchor">#</a> 原型链</h3> <p>原型链的概念，即每个对象拥有一个原型对象，通过 <code>__proto__</code> 指针指向上一个原型 ，并从中<strong>继承方法和属性</strong>，同时原型对象也可能拥有原型，这样一层一层，最终指向 <code>null</code>，这种关系被称为<strong>原型链</strong>(prototype chain)。</p> <ul><li><p>当一个对象A作为原型时，它有一个constructor属性指向它的构造函数，即<code>A.constructor</code></p></li> <li><p>当一个对象B作为构造函数时，它有一个prototype属性指向它的原型，即<code>B.prototype</code></p></li> <li><p>当一个对象C作为实例时，它有一个<code>__proto__</code>属性指向它的原型，即<code>C.__proto__</code></p></li> <li><p>当想要判断一个**对象<code>foo</code><strong>是否是</strong>构造函数<code>Foo</code>**的实例时，可以使用<code>instanceof</code>关键字，返回一个boolean值</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">var</span> add <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Add</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'return a + b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// add 是一个实例，对应的构造函数是 Add 原型是 Add.prototype</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>add<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Add</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token comment">// 注意 Add同时是Add.prototype的构造函数与实例</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Add</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Add<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Add<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Add</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true  </span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>Object<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>  <span class="token comment">// true</span>
<span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span> <span class="token comment">// true</span>
<span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token comment">// true</span>
</code></pre></div><h3 id="继承"><a href="#继承" class="header-anchor">#</a> 继承</h3> <p>最基本的继承被分为<strong>构造函数的继承</strong>与<strong>原型的继承</strong>两种。</p> <ul><li>原型链与构造函数 -&gt; 组合式继承</li></ul> <ul><li>原型链改进 -&gt; 原型式</li></ul> <ul><li><p>原型式封装增强 -&gt; 寄生式</p></li> <li><p>寄生式与构造函数 -&gt; 寄生组合式继承</p></li></ul> <h4 id="原型链继承"><a href="#原型链继承" class="header-anchor">#</a> 原型链继承</h4> <p>考虑一点：如何将子类对象的原型加到原型链中？</p> <p>答：<strong>让子类对象的原型成为父类对象的一个实例</strong>，然后通过<code>__proto__</code>访问父类对象的原型<code>subType.prototype = new SuperType()</code></p> <p>等价于-&gt;</p> <p><code>subType.prototype.__proto__ = SuperType.prototype</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'blue'</span><span class="token punctuation">,</span><span class="token string">'green'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getSuperValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>colors
<span class="token punctuation">}</span>


<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// 原型链继承了SuperType</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> instance1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance1<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;black&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance1<span class="token punctuation">.</span>colors <span class="token comment">//['red','blue','green','black']</span>

<span class="token keyword">var</span> instance2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance2<span class="token punctuation">.</span>colors <span class="token comment">//['red','blue','green','black']</span>
</code></pre></div><blockquote><p>注意：给原型添加方法的语句一定要放在原型替换<code>SubType.prototype = new SuperType()</code>之后</p></blockquote> <p>优点：能通过<code>instanceO</code>f和<code>isPrototypeOf</code>的检测</p> <p>缺点：(1)<code>SuperType</code>中的属性(不是方法)也变成了<code>SubType的prototype</code>中的公用属性，
如上面例子中的color属性，可以同时被<code>instance1和instance2</code>修改
(2)创建子类型的时候，不能像父类型的构造函数中传递参数。</p> <h4 id="构造函数继承"><a href="#构造函数继承" class="header-anchor">#</a> 构造函数继承</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'blue'</span><span class="token punctuation">,</span><span class="token string">'green'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 构造函数继承</span>
	<span class="token function">Super</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> subInstance1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
subInstance<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'black'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>subInstance<span class="token punctuation">.</span>colors<span class="token punctuation">)</span> <span class="token comment">// ['red','blue','green','black']</span>

<span class="token keyword">var</span> subInstance2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
subInstance2<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'black'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>subInstance2<span class="token punctuation">.</span>colors<span class="token punctuation">)</span> <span class="token comment">// ['red','blue','green']</span>
</code></pre></div><p>原理：在子类型构造函数的内部调用超类型构造函数
优点：解决了<code>superType</code>中的私有属性变公有的问题，可以传递参数
缺点：方法在函数中定义，无法得到复用</p> <h4 id="组合继承"><a href="#组合继承" class="header-anchor">#</a> 组合继承</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'blue'</span><span class="token punctuation">,</span><span class="token string">'green'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 构造函数-&gt;继承属性</span>
    <span class="token function">SuperType</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token comment">//借用构造函数继承属性，二次调用</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
<span class="token punctuation">}</span>

<span class="token comment">// 原型链-&gt;继承方法</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 借用原型链继承方法，一次调用</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> SubType<span class="token punctuation">;</span> <span class="token comment">// 修正constructor属性</span>

<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayAge</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">&quot;Nicholas&quot;</span><span class="token punctuation">,</span><span class="token number">29</span><span class="token punctuation">)</span>
instance<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;black&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance1<span class="token punctuation">.</span>colors<span class="token punctuation">)</span>  <span class="token comment">// &quot;red,blue,green,black&quot;</span>
instance<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// &quot;Nicholas&quot;</span>
instance<span class="token punctuation">.</span><span class="token function">sayAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 29</span>
</code></pre></div><p>优点：继承前两者的优点，能通过<code>instanceOf</code>和<code>isPrototypeOf</code>的检测
缺点：两次调用父构造器函数，浪费内存。</p> <h4 id="原型式继承"><a href="#原型式继承" class="header-anchor">#</a> 原型式继承</h4> <p>有点像原型链继承的变形，实际上多了一层中间层</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">object</span><span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> o
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span><span class="token string">&quot;linwei&quot;</span><span class="token punctuation">,</span>
    friends<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;abing&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;zihui&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;jiawei&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;chenfeng&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> anotherPerson <span class="token operator">=</span> <span class="token function">object</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>  
anotherPerson<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;linwe2&quot;</span>
anotherPerson<span class="token punctuation">.</span>friends<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;Rob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
anotherPerson<span class="token punctuation">.</span>name  <span class="token comment">// &quot;linwei2&quot;</span>

<span class="token keyword">var</span> yetAnotherPerson <span class="token operator">=</span> <span class="token function">object</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span> 
yetAnotherPerson<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;linwei3&quot;</span>
yetAnotherPerson<span class="token punctuation">.</span>friends<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;Barbie&quot;</span><span class="token punctuation">)</span> 

yetAnotherPerson<span class="token punctuation">.</span>friends
yetAnotherPerson<span class="token punctuation">.</span>name<span class="token punctuation">;</span> <span class="token comment">// &quot;linwei3&quot;</span>

person<span class="token punctuation">.</span>name <span class="token comment">// &quot;linwei&quot;</span>
person<span class="token punctuation">.</span>friends  <span class="token comment">// [&quot;abing,zihui,jiawei,chenfeng,Rob,Barbie&quot;]</span>
</code></pre></div><p>使用场合：没必要构建构造函数，仅仅是想模拟一个对象的时候</p> <h4 id="寄生继承"><a href="#寄生继承" class="header-anchor">#</a> 寄生继承</h4> <p>封装继承过程的函数，实际上对原型式继承的增强</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createAnother</span><span class="token punctuation">(</span><span class="token parameter">original</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">var</span> clone <span class="token operator">=</span> <span class="token function">object</span><span class="token punctuation">(</span>original<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 原型式继承调用</span>
    clone<span class="token punctuation">.</span><span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token comment">// 增强对象</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hi'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> clone
<span class="token punctuation">}</span>
<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span><span class="token string">&quot;linwei&quot;</span><span class="token punctuation">,</span>
    friends<span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;abing&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;zihui&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;jiawei&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;chenfeng&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> anotherPerson <span class="token operator">=</span> <span class="token function">createAnother</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
anotherPerson<span class="token punctuation">.</span><span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 'hi'</span>
</code></pre></div><p>缺点与构造函数类似： 不能做到函数复用</p> <h4 id="寄生组合继承（es5）"><a href="#寄生组合继承（es5）" class="header-anchor">#</a> 寄生组合继承（<code>ES5</code>）</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 第一种写法，便于理解</span>

<span class="token keyword">function</span> <span class="token function">object</span><span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> o
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">subType<span class="token punctuation">,</span>superType</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 原型式继承</span>
    <span class="token keyword">let</span> proto <span class="token operator">=</span> <span class="token function">object</span><span class="token punctuation">(</span>superType<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>
    <span class="token comment">// 寄生式继承，增强原型对象</span>
    proto<span class="token punctuation">.</span>constructor <span class="token operator">=</span> subType
    subType<span class="token punctuation">.</span>prototype <span class="token operator">=</span> proto 
<span class="token punctuation">}</span>
 
<span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'blue'</span><span class="token punctuation">,</span><span class="token string">'green'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getColors</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>colors<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 构造函数继承</span>
    <span class="token function">SuperType</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
<span class="token punctuation">}</span>

<span class="token function">create</span><span class="token punctuation">(</span>SubType<span class="token punctuation">,</span>SuperType<span class="token punctuation">)</span>
<span class="token comment">// 给子类原型添加方法的语句 一定要放在原型替换之后</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> subInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">'linwei'</span><span class="token punctuation">)</span>
subInstance<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 'linwei'</span>
subInstance<span class="token punctuation">.</span><span class="token function">getColors</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// ['red','blue','green']</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 第二种写法，模拟 ES5 Object.create</span>
<span class="token keyword">function</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">proto<span class="token punctuation">,</span>options</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 创建空对象，类似 new F()</span>
    <span class="token keyword">var</span> tmp <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">// 让空对象的__proto__指向父类的prototype（让空对象成为父类对象的实例）</span>
    tmp<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> proto
    <span class="token comment">// 传入的方法都挂载都新对象上，包括增强对象的方法，修补constructor</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>tmp<span class="token punctuation">,</span>options<span class="token punctuation">)</span>
    <span class="token comment">// 返回对象，作为子类对象的原型</span>
    <span class="token keyword">return</span> tmp
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'blue'</span><span class="token punctuation">,</span><span class="token string">'green'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getColors</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>colors<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 构造函数继承</span>
    <span class="token function">SuperType</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
<span class="token punctuation">}</span>

<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span><span class="token punctuation">{</span>
    <span class="token comment">// 不要忘了重新指定构造函数</span>
    constructor<span class="token operator">:</span><span class="token punctuation">{</span>
        value<span class="token operator">:</span>SubType
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 添加子类方法</span>
    getName<span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token function-variable function">value</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> subInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">'linwei'</span><span class="token punctuation">)</span>
subInstance<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 'linwei'</span>
subInstance<span class="token punctuation">.</span><span class="token function">getColors</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// ['red','blue','green']</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 第三种，用 ES5 自带的 Object.create()</span>
<span class="token comment">// 注：Object.create() 并不会默认自动修正constructor，需要传入 options: { constructor }</span>

<span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'blue'</span><span class="token punctuation">,</span><span class="token string">'green'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getColors</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>colors<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">SuperType</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
<span class="token punctuation">}</span>

<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span><span class="token punctuation">{</span>
    constructor<span class="token operator">:</span><span class="token punctuation">{</span>
        value<span class="token operator">:</span>SubType
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    getName<span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token function-variable function">value</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> subInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">'linwei'</span><span class="token punctuation">)</span>
subInstance<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">// 'linwei'</span>
subInstance<span class="token punctuation">.</span><span class="token function">getColors</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// ['red','blue','green']</span>
</code></pre></div><h4 id="es6继承"><a href="#es6继承" class="header-anchor">#</a> <code>ES6</code>继承</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">SuperType</span><span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// 构造函数</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'red'</span><span class="token punctuation">,</span><span class="token string">'blue'</span><span class="token punctuation">,</span><span class="token string">'green'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 原型方法，这种写法表示将方法添加到原型中</span>
    <span class="token function">getColors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>colors<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 静态属性、方法，等同于 SuperType.a = 20</span>
    <span class="token keyword">static</span> a <span class="token operator">=</span> <span class="token number">20</span>
	
	<span class="token comment">// 构造函数中添加，相当于 this.c = 20 </span>
	c <span class="token operator">=</span> <span class="token number">20</span>

	<span class="token comment">// 构造函数中添加，相当于 this.age = () =&gt; this.age</span>
	<span class="token function-variable function">getAge</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>age
	<span class="token comment">// getAge = function () {}</span>

<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">SubType</span> <span class="token keyword">extends</span> <span class="token class-name">SuperType</span><span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
    <span class="token punctuation">}</span>
    <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> subInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">'linwei'</span><span class="token punctuation">)</span>
subInstance<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>	<span class="token comment">// 'linwei'</span>
subInstance<span class="token punctuation">.</span><span class="token function">getColors</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// ['red','blue','green']</span>
</code></pre></div><h2 id="_6、数组去重"><a href="#_6、数组去重" class="header-anchor">#</a> 6、数组去重</h2> <h3 id="双层for循环"><a href="#双层for循环" class="header-anchor">#</a> 双层for循环</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">distinct</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> arr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                arr<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// splice 会改变数组长度，所以要将数组长度 len 和下标 j 减一</span>
                len<span class="token operator">--</span><span class="token punctuation">;</span>
                j<span class="token operator">--</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> arr<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="array-filter-加indexof"><a href="#array-filter-加indexof" class="header-anchor">#</a> <code>Array.filter()</code>加<code>indexOf</code></h3> <blockquote><p>思想: 利用<code>indexOf</code>检测元素在数组中第一次出现的位置是否和元素现在的位置相等，如果不等则说明该元素是重复元素</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">distince</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span>index</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">===</span> index
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="es6-中的-set-去重"><a href="#es6-中的-set-去重" class="header-anchor">#</a> <code>ES6</code> 中的 Set 去重</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">distinct</span><span class="token punctuation">(</span><span class="token parameter">array</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Array.from()方法就是将一个类数组对象或者可遍历对象转换成一个真正的数组。</span>
<span class="token punctuation">}</span>
</code></pre></div><p>用<code>...</code>扩展运算符改写：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">distinct</span><span class="token punctuation">(</span><span class="token parameter">array</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>new <span class="token class-name">Set</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment">// new Set返回一个类数组</span>
<span class="token punctuation">}</span>
</code></pre></div><p>用<code>ES6</code>箭头函数进一步改写：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> <span class="token function-variable function">distince</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">array</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token operator">...</span>new <span class="token class-name">Set</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">]</span>
</code></pre></div><h2 id="_7、谈谈闭包"><a href="#_7、谈谈闭包" class="header-anchor">#</a> 7、谈谈闭包</h2> <blockquote><p>闭包（closure）指 有权访问另一函数作用域中变量的 函数 —— JavaScript高级程序设计</p></blockquote> <p>闭包就是<strong>在函数里面声明函数</strong>，在<strong>函数内部</strong>和<strong>函数外部搭</strong>建起一座<strong>桥梁</strong>（从<strong>函数内部</strong>将<strong>函数返回</strong>给<strong>函数外部</strong>），使得<strong>子函数</strong>可以<strong>访问父函数</strong>中所有的<strong>局部变量</strong>（能<strong>访问父函数作用域</strong>）。</p> <ul><li><p>作用：可以私有化变量，保护变量不受外界污染。</p></li> <li><p>缺点：造成内存泄露。
造成<strong>内存泄露</strong>：死循环、定时器、全局变量</p></li></ul> <p>tip：闭包不会造成作用域链的改变。  ——JavaScript核心技术开发解密</p> <h2 id="_8、es6的新特性"><a href="#_8、es6的新特性" class="header-anchor">#</a> 8、<code>ES6</code>的新特性</h2> <p><code>let</code>、<code>const</code> 不会挂载到window上</p> <h3 id="let"><a href="#let" class="header-anchor">#</a> <code>let</code></h3> <ul><li>定义<strong>块级作用域</strong>变量</li> <li>没有变量的提升，必须先声明后使用</li> <li>不能与前面的<code>let</code>，<code>var</code>，<code>conset</code>声明的变量重名</li></ul> <h3 id="const"><a href="#const" class="header-anchor">#</a> <code>const</code></h3> <ul><li><p>定义变量也是一个<strong>块级作用域</strong>变量</p></li> <li><p>没有变量的提升，必须先声明后使用</p></li> <li><p>不能与前面的<code>let</code>，<code>var</code>，<code>conset</code>声明的变量重名</p></li> <li><p>定义只读变量</p></li> <li><p>声明变量的同时必须赋值，声明的变量必须<strong>初始化</strong>，一旦初始化完毕就不允许修改</p> <blockquote><p>注：不允许修改指的是值的修改，若为引用类型，则只要地址不变就可以</p> <p>如：定义的对象\数组中的属性值可以修改,基础数据类型不可以</p></blockquote></li></ul> <h3 id="let、const-和var三者都会存在变量提升"><a href="#let、const-和var三者都会存在变量提升" class="header-anchor">#</a> <code>let</code>、<code>const</code> 和<code>var</code>三者都会存在变量提升</h3> <ul><li><p><code>let</code> 的「创建」过程被提升了，但是 [初始化] 没有提升，所以会产生暂时性死区（执行 log 时 x 还没「初始化」，所以不能使用（也就是所谓的暂时死区）)</p></li> <li><p><code>var</code> 的「创建」和「初始化」都被提升了，所以在赋值前访问会得到undefined</p></li> <li><p><code>function</code> 的「创建」「初始化」和「赋值」都被提升了。</p></li></ul> <h3 id="扩展运算符和rest运算符（-）"><a href="#扩展运算符和rest运算符（-）" class="header-anchor">#</a> 扩展运算符和rest运算符（...）</h3> <blockquote><p>扩展运算符（ spread ）是三个点（...）。它好比 rest 参数的逆运算，将一个数组转为用逗号分隔的参数序列。</p></blockquote> <ul><li><p>函数传参（替代数组的 apply 方法）</p> <p>由于<strong>扩展运算符</strong>可以展开数组，所以不再需要apply方法，将数组转为函数的参数了。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ES5 的写法  </span>
<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
	<span class="token comment">// ...  </span>
<span class="token punctuation">}</span>  
<span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  
<span class="token function">f</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>  

<span class="token comment">// ES6 的写法  </span>
<span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
	<span class="token comment">// ...  </span>
<span class="token punctuation">}</span>  
<span class="token keyword">var</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  
<span class="token function">f</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>  
</code></pre></div></li> <li><p>函数接收参数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span>  <span class="token comment">// [1,2,3,4]</span>
<span class="token punctuation">}</span>

<span class="token function">f</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>合并数组</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ES5 的合并数组  </span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>more<span class="token punctuation">)</span>  
arr1<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>arr2<span class="token punctuation">,</span> arr3<span class="token punctuation">)</span><span class="token punctuation">;</span>  

<span class="token comment">// ES6 的合并数组  </span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">...</span>more<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token operator">...</span>arr1<span class="token punctuation">,</span> <span class="token operator">...</span>arr2<span class="token punctuation">,</span> <span class="token operator">...</span>arr3<span class="token punctuation">]</span>  
</code></pre></div></li> <li><p>结合解构赋值</p> <p>如果将扩展运算符用于数组赋值，只能放在参数的最后一位，否则会报错。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>first<span class="token punctuation">,</span> <span class="token operator">...</span>rest<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  
first <span class="token comment">// 1  </span>
rest <span class="token comment">// [2, 3, 4, 5]  </span>

<span class="token keyword">const</span> <span class="token punctuation">[</span>first<span class="token punctuation">,</span> <span class="token operator">...</span>rest<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  
first <span class="token comment">// undefined  </span>
rest <span class="token comment">// []</span>

<span class="token keyword">const</span> <span class="token punctuation">[</span>first<span class="token punctuation">,</span> <span class="token operator">...</span>rest<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  
first <span class="token comment">// &quot;foo&quot;  </span>
rest <span class="token comment">// []  </span>

<span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token operator">...</span>butLast<span class="token punctuation">,</span> last<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  
<span class="token comment">//  报错  </span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>first<span class="token punctuation">,</span> <span class="token operator">...</span>middle<span class="token punctuation">,</span> last<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  
<span class="token comment">//  报错  </span>
</code></pre></div></li> <li><p>字符串</p> <p>扩展运算符还可以将字符串转为真正的数组。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span><span class="token operator">...</span><span class="token string">'hello'</span><span class="token punctuation">]</span>  
<span class="token comment">// [ &quot;h&quot;, &quot;e&quot;, &quot;l&quot;, &quot;l&quot;, &quot;o&quot; ]  </span>
</code></pre></div></li> <li><p>实现了 Iterator 接口的对象</p> <p>扩展运算符内部调用的是数据结构的 Iterator 接口，因此只要具有 Iterator 接口的对象，都可以使用扩展运算符<strong>转为真正的数组</strong>，比如 Map 和 Set 结构， Generator 函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> nodeList <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>nodeList<span class="token punctuation">]</span><span class="token punctuation">;</span>  
<span class="token comment">// 上面代码中，querySelectorAll方法返回的是一个nodeList对象。它不是数组，而是一个类似数组的对象。</span>

<span class="token keyword">function</span> <span class="token function">distinct</span><span class="token punctuation">(</span><span class="token parameter">array</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//ES6</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token operator">...</span>new <span class="token class-name">Set</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment">// new Set返回一个类数组</span>
<span class="token punctuation">}</span>

<span class="token comment">// ES5</span>
<span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span> 
</code></pre></div></li></ul> <h3 id="数组与对象的解构赋值"><a href="#数组与对象的解构赋值" class="header-anchor">#</a> 数组与对象的解构赋值</h3> <h3 id="箭头函数"><a href="#箭头函数" class="header-anchor">#</a> 箭头函数</h3> <h3 id="遍历数组的新方法"><a href="#遍历数组的新方法" class="header-anchor">#</a> 遍历数组的新方法</h3> <p><code>array.map()</code>、<code>array.filter()</code>、<code>array.forEach()</code></p> <h2 id="_9、es6遍历数组的方法区别"><a href="#_9、es6遍历数组的方法区别" class="header-anchor">#</a> 9、<code>ES6</code>遍历数组的方法区别</h2> <p><code>map</code>和<code>forEach</code>的区别</p> <p><strong>相同点：</strong></p> <ul><li>都是循环遍历数组中的每一项</li></ul> <ul><li><code>forEach</code>和<code>map</code>方法里每次执行匿名函数都支持3个参数，参数分别是item（当前每一项）、index（索引值）、arr（原数组），需要用哪个的时候就写哪个</li></ul> <ul><li><p>匿名函数中的this都是指向window</p></li> <li><p>只能遍历数组</p></li></ul> <p><strong>不同点：</strong></p> <ul><li><p><code>map()</code>方法<strong>返回一个新的数组</strong>，数组中的元素为<strong>原始数组调用函数处理后的值</strong>。(原数组进行处理之后对应的一个新的数组)</p></li> <li><p><code>map()</code>方法不会改变原始数组</p></li> <li><p><code>map()</code>方法不会对空数组进行检测</p></li> <li><p><code>forEach()</code>方法用于调用数组的每个元素，将元素传给回调函数。(没有return，返回值是undefined）</p></li></ul> <blockquote><p>注意：<code>forEach</code>对于空数组是不会调用回调函数的。</p></blockquote> <h2 id="_10、用reduce实现promise串行执行"><a href="#_10、用reduce实现promise串行执行" class="header-anchor">#</a> 10、用reduce实现Promise串行执行</h2> <p>在 <code>async/await</code> 以前 Promise 串行执行还是比较麻烦的</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">runPromiseByQueue</span><span class="token punctuation">(</span><span class="token parameter">promiseArray</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> firstPromise <span class="token operator">=</span> promiseArray<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	promiseArray<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>
        <span class="token punctuation">(</span><span class="token parameter">previousPromise<span class="token punctuation">,</span>nextPromise</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> previousPromise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
            <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">nextPromise</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token function">firstPromise</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 先调用数组中第一个函数，返回一个Promise，就可以.then了</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 或</span>
<span class="token keyword">function</span> <span class="token function">runPromiseByQueue</span><span class="token punctuation">(</span><span class="token parameter">promiseArray</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    promiseArray<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>
    	<span class="token punctuation">(</span><span class="token parameter">previousPromise<span class="token punctuation">,</span>nextPromise</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> previousPromise<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
        	<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">nextPromise</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 第一个值就是一个决议的Promise，可以.then</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>当上一个 Promise 开始执行（<code>previousPromise.then</code>），当其执行完毕后再调用下一个 Promise，并作为一个新 Promise 返回，下次迭代就会继续这个循环。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">createPromise</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">time<span class="token punctuation">,</span> id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">solve</span> <span class="token operator">=&gt;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;promise&quot;</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">runPromiseByQueue</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token function">createPromise</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">createPromise</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">createPromise</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 结果：</span>
promise <span class="token number">1</span> <span class="token comment">// 等待3秒</span>
promise <span class="token number">2</span> <span class="token comment">// 等待上一个输出后2秒</span>
promise <span class="token number">3</span> <span class="token comment">// 等待上一个输出后1秒</span>
</code></pre></div><p>在 <code>async/await</code> 的支持下，<code>runPromiseByQueue</code> 函数可以更为简化：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">runPromiseByQueue</span><span class="token punctuation">(</span><span class="token parameter">promiseArray</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> fun <span class="token keyword">of</span> promiseArray<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">await</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_11、浏览器javascript的eventloop"><a href="#_11、浏览器javascript的eventloop" class="header-anchor">#</a> 11、<a href="https://juejin.im/post/5b97d2b55188255c781ca228" target="_blank" rel="noopener noreferrer">浏览器JavaScript的<code>EventLoop</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <p>我们要记住最重要的两点：<code>JavaScript</code>是单线程和<code>eventloop</code>的循环机制。</p> <p>我们常常吧<code>EventLoop</code>中分为 内存、执行栈、<code>WebApi</code>、异步回调队列(包括微任务队列和宏任务队列)</p> <p><img src="https://user-gold-cdn.xitu.io/2018/9/11/165c910691ef28b9?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt=""></p> <h3 id="任务分类"><a href="#任务分类" class="header-anchor">#</a> 任务分类</h3> <p>宏任务(<code>macrotask</code>)</p> <ul><li><code>setTimeOut</code> 、 <code>setInterval</code> 、<code>postMessage</code>、 <code>setImmediate</code> 、 <code>I/O</code> 、 各种<code>callback</code>、<code>UI渲染等</code></li> <li>优先级： <code>主代码块script(整体代码)</code> &gt; <code>setImmediate(Node.js 环境)</code> &gt; <code>MessageChannel</code> &gt; <code>setTimeOut</code>/<code>setInterval</code></li></ul> <p>微任务(<code>microtask</code>)</p> <ul><li><code>process.nextTick(Node.js 环境)</code> 、<code>Promise</code>  、<code>MutationObserver</code> 、<code>async(实质上也是promise)</code></li> <li>优先级： <code>process.nextTick</code> &gt; <code>Promise.then</code> &gt; <code>MutationOberser</code></li></ul> <h3 id="执行栈"><a href="#执行栈" class="header-anchor">#</a> 执行栈</h3> <ul><li>执行栈是宏任务被执行的地方</li></ul> <h3 id="宏任务-宏任务队列"><a href="#宏任务-宏任务队列" class="header-anchor">#</a> 宏任务 &amp; 宏任务队列</h3> <ul><li>宏任务总会在下一个<code>EventLoop</code>中执行</li> <li>若在执行宏任务的过程中，加入了新的<code>微任务</code>，会把新的微任务添加到微任务的队列中。</li></ul> <h3 id="微任务-微任务队列"><a href="#微任务-微任务队列" class="header-anchor">#</a> 微任务 &amp;  微任务队列</h3> <ul><li>若在执行微任务的过程中，加入了新的微任务，会把新的微任务添加在当前微任务队列的队尾巴。</li> <li>微任务会在本轮<code>EventLoop</code>执行完后，马上把执行栈中的任务都执行完毕。</li></ul> <h3 id="执行流程"><a href="#执行流程" class="header-anchor">#</a> 执行流程</h3> <p>① <code>Javascript</code>内核加载代码到<code>执行栈</code>
② <code>执行栈</code>依次执行主线程的<code>同步任务</code>，过程中若遇调用了异步Api则会添加回调事件到<code>回调队列</code>中。且<code>微任务</code>事件添加到微任务队列中，<code>宏任务</code>事件添加到宏任务队列中去。直到当前<code>执行栈</code>中代码执行完毕。
③ 开始执行当前所有<code>微任务队列</code>中的微任务回调事件。    (😏注意是所有哦，相当于清空队列)
④ 取出<code>宏任务队列</code>中的第一条(先进先出原则哦)宏任务，放到<code>执行栈</code>中执行。
⑤  执行当前<code>执行栈</code>中的宏任务，若此过程总又再遇到<code>微任务</code>或者<code>宏任务</code>，继续把<code>微任务</code>和<code>宏任务</code>进行各自队伍的<code>入队</code>操作，然后本轮的<code>宏任务</code>执行完后，又把本轮产生的<code>微任务</code>一次性出队都执行了。
⑥ 以上操作往复循环...就是我们平时说的<code>eventLoop</code>了</p> <h3 id="其他相关"><a href="#其他相关" class="header-anchor">#</a> 其他相关</h3> <h4 id="promise-then链式调用"><a href="#promise-then链式调用" class="header-anchor">#</a> Promise.then链式调用</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;promise1&quot;</span><span class="token punctuation">)</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;then11&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;promise2&quot;</span><span class="token punctuation">)</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;then21&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;then23&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;then12&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 结果：</span>
promise1
then11
promise2
then21
then12  <span class="token comment">// 为什么then21在then12前，而then12在then23前，因为在promise2执行完后代表then11也执行完，所以会在微任务队列里先添加最近的then21，再添加then12，然后执行完21，就会再添加23，执行12，最后执行23</span>
then23
</code></pre></div><p>如果说这边的Promise中then返回一个Promise呢？？</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;promise1&quot;</span><span class="token punctuation">)</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;then11&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;promise2&quot;</span><span class="token punctuation">)</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;then21&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;then23&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;then12&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 结果：</span>
promise1
then11
promise2
then21
then23
then12   <span class="token comment">// then12必须等return的Promise决议后才能执行回调函数，所以必须等最后一个promise then23决议后，才能执行then12回调</span>
</code></pre></div><p>如果说这边不止一个Promise呢，再加一个new Promise是否会影响结果？？</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;promise1&quot;</span><span class="token punctuation">)</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;then11&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;promise2&quot;</span><span class="token punctuation">)</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;then21&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;then23&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;then12&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span>reject</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;promise3&quot;</span><span class="token punctuation">)</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;then31&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 结果</span>
promise1
promise3
then11
promise2
then31
then21
then12
then23
</code></pre></div><h4 id="async-await"><a href="#async-await" class="header-anchor">#</a> async-await</h4> <p>其实，async-await 只是 Promise+generator 的一种语法糖而已。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token constant">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> now <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>now<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token constant">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 结果：</span>
<span class="token number">1</span>
Math<span class="token punctuation">.</span><span class="token function">rendom</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token number">2</span>
Date<span class="token punctuation">.</span><span class="token function">noew</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>上面的代码我们改写为这样，可以更加清晰一点：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token constant">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token constant">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">now</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>now<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token constant">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>练习：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;async1 start&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">await</span>  <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;async1 end&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span>  <span class="token keyword">function</span> <span class="token function">async2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span> <span class="token string">'async2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;script start&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;settimeout&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">async1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;promise1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;promise2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'script end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token comment">// 结果</span>
script start
async1 start
async2
promise1
script end
async1 end
promise2
settimeout
</code></pre></div><h4 id="settimeout"><a href="#settimeout" class="header-anchor">#</a> setTimeout</h4> <p>Q: 我的<code>setTimeout</code>函数到时间了，为啥一直不去执行。</p> <p>A: <code>setTimeOut</code>的回调会被放到任务队列中，需要当前的执行栈执行完了，才会去执行执行任务队列中的内容。出现<code>setTimeout</code>回调不及时，说明在执行栈中出现了阻塞，或者说执行代码过多。</p> <h4 id="nexttick"><a href="#nexttick" class="header-anchor">#</a> nextTick</h4> <p>常见的<code>vue.$nextTick</code>会把事件直接插入到当前<code>微任务</code>队列的中，感兴趣的请看笔记《vue_nextTick与eventLoop》  <a href="https://github.com/HXWfromDJTU/blog/blob/master/vue/nextTick.md" target="_blank" rel="noopener noreferrer">传送门--&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 和 《vue_DOM更新与nextTick》<a href="https://github.com/HXWfromDJTU/blog/blob/master/vue/vue_dom_nextTick.md" target="_blank" rel="noopener noreferrer">传送门--&gt;<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/LINWEIya/blog/edit/master/javascript/interview.md" target="_blank" rel="noopener noreferrer">编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">3/9/2020, 9:13:46 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/blog/javascript/handwriting.html">手写代码</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.88060982.js" defer></script><script src="/blog/assets/js/2.8cf76fce.js" defer></script><script src="/blog/assets/js/11.5de2d7f7.js" defer></script>
  </body>
</html>
